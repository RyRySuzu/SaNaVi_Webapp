function sanavi(){var al=[];var S=[];var ad=[];var ak=[];var aa=[];var e=[];var ar=[];var B=[];var av=[];var aK=[];var aj=[];var ao=[];var af=[];var az=[];var E=[];var d=[];var f=[];var y=[];var aI=[];var ac=[];var M=[];var F=[];var ax=[];var aC=[];var G=[];var V=[];var w=[];var H=[];var ap=[];var U=[];var an=[];var C=[];var o=[];var s=new Boolean(false);var u;var aF;var j=[];var aE=[];var aB=0;var v=new Boolean(false);var Q=[];var t=[];var aw=[];var c=[];var b=[];var I=[];var Y=[];var L=new Boolean(false);var J=new Boolean(false);var a=new Boolean(false);var N=[];var au=0;var D=[];var h=111111111;var r=0;var k=0;var ah=0;var ae=0;var at;var z;var Z;var n;var T;var A;var aq=new Boolean(false);var ay=new Boolean(false);var am=new Boolean(false);function P(){$("#checklisttable label").addClass("ui-checkbox-on").removeClass("ui-checkbox-off");$("#checklisttable span.ui-icon").addClass("ui-icon-checkbox-on").removeClass("ui-icon-checkbox-off");$('input[type="checkbox"]').each(function(){$("#checklisttable input").each(function(){$(this).prop("checked",false)});$("#checklisttable label").addClass("ui-checkbox-off").removeClass("ui-checkbox-on");$("#checklisttable span.ui-icon").addClass("ui-icon-checkbox-off").removeClass("ui-icon-checkbox-on")})}$(function(){$("#response").html("Response Values");$("#button_search").click(function(){var aL={ship_id:$("#value1").val()};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/get_ship_name_id_Azure_Ima.php",data:aL,cache:false,dataType:"json",success:function(aR){W(ak);W(S);for(var aS in aR){y[aS]=parseFloat(aR[aS].lat);aI[aS]=parseFloat(aR[aS].lon);ac[aS]=(aR[aS].ship_name);F[aS]=(aR[aS].ship_id);M[aS]=parseFloat(aR[aS].direction);ax[aS]=(aR[aS].speed);G[aS]=(aR[aS].kakudo);var aP=new google.maps.LatLng(y[aS],aI[aS]);ax[aS]=ax[aS]*100;ax[aS]=Math.round(ax[aS])/100;var aT=new google.maps.Marker({position:aP,map:A,title:"Maybe you are here now.",icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,scale:5,fillOpacity:1,fillColor:"#000000",strokeColor:"#ffffff",strokeWeight:2,rotation:M[aS]}});var aN=document.createElement("div");aN.innerHTML="<div class='arrow_box'><br><div style='font-size: medium;'>　船名:"+ac[aS]+"<br>　速度:"+ax[aS]+"km<br>　角度:"+G[aS]+"</div>";var aU={content:aN,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(-100,-140),zIndex:null,boxStyle:{width:"210px"},closeBoxMargin:"10px 10px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};var aQ=new InfoBox(aU);ai(aT,aQ);S.push(new aH(aT,aQ))}var aO={path:N,strokeWeight:5,strokeColor:"#0000ff",strokeOpacity:"0.5"};var aM=new google.maps.Polyline(aO);aM.setMap(A)}})})});$("#myTab1 a").click(function(aL){aL.stopPropagation();$(this).tab("show")});$(function(){if($.cookie("sample")){$("#login_now").text("船のid:"+$.cookie("sample")+"でログイン中です");h=$.cookie("sample")}$("#logout_start").click(function(){alert("Logout Complete");$.removeCookie("sample");location.href="http://toba-sanavi.azurewebsites.net/ImagineCup/sp/index.html"});$("#register_start").click(function(){location.href="http://toba-sanavi.azurewebsites.net/ImagineCup/sp/Register.html"});$("#login_comp").click(function(){var aL={ship_id:$("#loginid").val()};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/get_ship_id_login_Azure_Ima.php",data:aL,cache:false,dataType:"json",success:function(aM){D[0]=parseFloat(aM[0].login);if(D[0]==0){alert("Login Complete ");$.cookie("sample",$("#loginid").val());location.href="http://toba-sanavi.azurewebsites.net/ImagineCup/sp/index.html"}else{alert("Login failed")}}})})});setInterval(function(){if(am==true){if(h!=111111111){$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/sending_information_emergency_Azure_Ima.php",data:at,dataType:"json"});aN();aL()}$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/getting_data_latlon_Azure_Ima.php",data:at,cache:false,dataType:"json",success:function(aT){p(al);for(var aR in aT){e[aR]=parseFloat(aT[aR].lat);ar[aR]=parseFloat(aT[aR].lon);aK[aR]=parseFloat(aT[aR].ship_id);av[aR]=(aT[aR].ship_name);aj[aR]=parseFloat(aT[aR].direction);ao[aR]=(aT[aR].ship_type);af[aR]=(aT[aR].kakudo);az[aR]=parseFloat(aT[aR].speed);az[aR]=az[aR]*100;az[aR]=Math.round(az[aR])/100;var aU=new google.maps.LatLng(e[aR],ar[aR]);au=5;var aP=new google.maps.Marker({position:aU,map:A,title:"Maybe you are here now.",icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,scale:au,fillOpacity:1,fillColor:ao[aR],strokeColor:"#ffffff",strokeWeight:2,rotation:aj[aR]}});var aQ=document.createElement("div");aQ.innerHTML="<div class='arrow_box'><br><div style='font-size: medium;'>　船名:"+av[aR]+"<br>　速度:"+az[aR]+"km<br>　角度:"+af[aR]+"</div>";var aO={content:aQ,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(-100,-140),zIndex:null,boxStyle:{width:"210px"},closeBoxMargin:"10px 10px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};var aS=new InfoBox(aO);ai(aP,aS);al.push(new aH(aP,aS))}}});if(al){for(var aM=0;aM<al.length;aM++){m(al[aM])}}if(al){for(var aM=0;aM<al.length;aM++){g(al[aM])}}function aL(){ae=0;ah=0;var aO={ship_id:h};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/getting_data_emergency_Azure_Ima.php",data:aO,cache:false,dataType:"json",success:function(aQ){for(var aP in aQ){aL[aP]=parseFloat(aQ[aP].emergency);if(aL[aP]==0){ae++}else{ah++}}if(ae!=0){var aR={ship_id:h};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/emergency_sounan_Azure_Ima.php",data:aR,cache:false,dataType:"json",success:function(aV){if(aa){for(aT in aa){aa[aT].setMap(null)}aa.length=0}for(var aT in aV){Q[aT]=parseFloat(aV[aT].lat);t[aT]=parseFloat(aV[aT].lon);aE[aT]=parseFloat(aV[aT].emergency);I[aT]=parseFloat(aV[aT].flag);if(I[aT]==0){aq=true}var aU=new google.maps.LatLng(Q[aT],t[aT]);var aS=new google.maps.Marker({position:aU,map:A,title:"Maybe you are here now.",zIndex:1,icon:{path:google.maps.SymbolPath.CIRCLE,scale:100,fillOpacity:0.6,fillColor:"#FF0000",strokeColor:"#ffffff",strokeWeight:2}});aa.push(aS)}}});if(aa){for(aP in aa){aa[aP].setMap(A)}}if(aq==true){v=true;if(J==true){document.getElementById("approach").style.display="none";document.getElementById("emergency").style.display="none";document.getElementById("approach_emergency").style.display="block"}else{document.getElementById("approach").style.display="none";document.getElementById("approach_emergency").style.display="none";document.getElementById("emergency").style.display="block"}}}else{if(J==true){document.getElementById("emergency").style.display="none";document.getElementById("approach").style.display="block";document.getElementById("approach_emergency").style.display="none"}else{document.getElementById("approach").style.display="none";document.getElementById("approach_emergency").style.display="none";document.getElementById("emergency").style.display="none"}if(aa){v=false;for(aP in aa){aa[aP].setMap(null)}aa.length=0}aq=false}}});if(a==true&&ay==false||v==true&&ay==false){audio3.play();ay=true}if(a==false&&v==false){audio3.pause();ay=false}}function aN(){k=0;r=0;var aO={ship_id:h};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/getting_data_within20m_Azure_Ima.php",data:aO,cache:false,dataType:"json",success:function(aQ){for(var aP in aQ){aN[aP]=parseFloat(aQ[aP].approach);if(aN[aP]==0){k++}else{if(aN[aP]==1){r++}}}if(k!=0){document.getElementById("approach").style.display="block";audio3.load();audio3.play();a=true;L=true;J=true}else{document.getElementById("approach").style.display="none";audio3.pause();a=false;L=false;J=false}}})}}},3000);var aD={zoom:17,mapTypeIds:google.maps.MapTypeId.ROADMAP};A=new google.maps.Map(document.getElementById("map_canvas"),aD);Z=new google.maps.Geocoder();var ab={enableHighAccuracy:true};navigator.geolocation.watchPosition(ag,null,ab);function ag(aL){n=new google.maps.LatLng(aL.coords.latitude,aL.coords.longitude);A.setCenter(n);var aP=aL.coords.latitude;var aN=aL.coords.longitude;var aO=aL.coords.heading;var aM=aL.coords.speed;at={ship_id:h,lat:aP,lon:aN,direction:aO,speed:aM}}$(window).load(function(){$("#div-modal").modal("show");var aL=document.getElementById("buttonaudio");aL.addEventListener("click",function(){am=true;audio3.load();X()})});function X(){var aL=document.getElementById("map_canvas");google.maps.event.trigger(map_canvas,"resize")}function aH(aM,aL){this.marker=aM;this.infoWindow=aL}function ai(aL,aM){google.maps.event.addListener(aL,"click",function(aN){aM.open(aL.getMap(),aL)})}function g(aL){for(var aM=0;aM<aL.length;aM++){aL[aM].marker.setVisible(true)}}function m(aL){for(var aM=0;aM<aL.length;aM++){aL[aM].marker.setVisible(false);aL[aM].infoWindow.close()}}function W(aL){for(var aM=0;aM<aL.length;aM++){aL[aM].marker.setMap(null);aL[aM].infoWindow.setMap(null)}aL.length=0;return aL}function p(aL){for(var aM=0;aM<aL.length;aM++){aL[aM].marker.setMap(null)}aL.length=0;return aL}function R(aM,aO){if(aM==true){var aN=aO.toString();var aL={ship_type:aN};$.ajax({type:"post",url:"http://toba-sanavi.azurewebsites.net/ImagineCup/PHP/getting_ship_type_Azure_Ima.php",data:aL,cache:false,dataType:"json",success:function(aU){W(S);W(ak);W(al);for(var aS in aU){V[aS]=parseFloat(aU[aS].lat);w[aS]=parseFloat(aU[aS].lon);H[aS]=(aU[aS].ship_name);U[aS]=(aU[aS].ship_id);ap[aS]=(aU[aS].direction);C[aS]=(aU[aS].speed);an[aS]=(aU[aS].kakudo);var aV=new google.maps.LatLng(V[aS],w[aS]);C[aS]=C[aS]*100;C[aS]=Math.round(C[aS])/100;var aQ=new google.maps.Marker({position:aV,map:A,title:"Maybe you are here now.",icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,scale:5,fillOpacity:1,fillColor:"#A0522D",strokeColor:"#ffffff",strokeWeight:2,rotation:19}});var aR=document.createElement("div");aR.innerHTML="<div class='arrow_box'><br><div style='font-size: medium;'>　船名:"+H[aS]+"<br>　速度:"+C[aS]+"km<br>　角度:"+an[aS]+"</div>";var aP={content:aR,disableAutoPan:false,maxWidth:0,pixelOffset:new google.maps.Size(-100,-140),zIndex:null,boxStyle:{width:"210px"},closeBoxMargin:"10px 10px 2px 2px",closeBoxURL:"http://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};var aT=new InfoBox(aP);ai(aQ,aT);ak.push(new aH(aQ,aT))}}})}else{W(ak);W(al)}}function K(){if(jQuery("#cb_gyosen").prop("checked")==true){am=false;P();$("#cb_gyosen").prop("checked",true);R(true,"漁船")}else{am=true;P();R(false,"漁船")}}function aG(){if(jQuery("#cb_ryokyaku").prop("checked")==true){am=false;P();$("#cb_ryokyaku").prop("checked",true);R(true,"旅客船")}else{am=true;P();R(false,"旅客船")}}function i(){if(jQuery("#cb_kamotu").prop("checked")==true){am=false;P();$("#cb_kamotu").prop("checked",true);R(true,"貨物船")}else{am=true;P();R(false,"貨物船")}}function q(){if(jQuery("#cb_kousoku").prop("checked")==true){am=false;P();$("#cb_kousoku").prop("checked",true);R(true,"高速船")}else{am=true;P();R(false,"高速船")}}function aJ(){if(jQuery("#cb_tannka").prop("checked")==true){am=false;P();$("#cb_tannka").prop("checked",true);R(true,"タンカー")}else{am=true;P();R(false,"タンカー")}}function O(){if(jQuery("#cb_rezya").prop("checked")==true){am=false;P();$("#cb_rezya").prop("checked",true);R(true,"レジャー")}else{am=true;P();R(false,"レジャー")}}function aA(){if(jQuery("#cb_tag").prop("checked")==true){am=false;P();$("#cb_tag").prop("checked",true);R(true,"タグ、パイロット船")}else{am=true;P();R(false,"タグ、パイロット船")}}function l(){if(jQuery("#cb_others").prop("checked")==true){am=false;P();$("#cb_others").prop("checked",true);R(true,"ヨット、その他")}else{am=true;P();R(false,"ヨット、その他")}}function x(){if(jQuery("#cb_minyuryoku").prop("checked")==true){am=false;P();$("#cb_minyuryoku").prop("checked",true);R(true,"未入力")}else{am=true;P();R(false,"未入力")}}};
